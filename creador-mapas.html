<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="awds_rebalanced.ico">
    <title>Creador de mapasAWDS Rebalanced</title>
  </head>
  <body>
    <div id="contenedor-forma" class="relative">
      <style>
        .boton-duda{
          --tamano: 40px;
          width: var(--tamano);
          height: var(--tamano);
          position: absolute;
          top: 15px; right: 15px;
          background-color: orange;
          border-radius: 8px;
          border: rgba(73, 59, 42, 0.671) solid 2px;
          cursor: pointer;
        }
      </style>
      <script>
        window.addEventListener('load', ()=>{
          document.querySelector('#btn-ayuda').addEventListener('click', (ev)=>{
            document.querySelector(ev.target.getAttribute('data-bs-target')).classList.add('activo')
          });
        });
      </script>
      <button id="btn-ayuda" class="boton-duda text-center rounded-md text-3xl font-black" data-bs-target="#modal-recomendaciones">?</button>

      <h1 class="text-3xl font-bold text-center mb-2">Creador de mapas</h1>

      <form id="creador-mapas" action="" class="bg-gray-50 text-black p-4 mx-auto mb-3 flex flex-col rounded-md" style="max-width: 650px; row-gap: .5rem;">
        <div class="seccion-nombre dato flex items-center justify-center gap-3">
          <label for="nombre-mapa">Nombre del mapa</label>
          <!-- Aplicar un regex al nombre del mapa -->
          <!-- El nombre del mapa tal vez pudiera ponerlo hasta que hagas clic en guardar -->
          <input name="nombre-mapa" id="nombre-mapa" type="text" class="input bg-gray-200 rounded-sm p-1 grow-1" maxlength="50" >
        </div>
        <div id="seccion-dimensiones" class="grid grid-cols-3 grid-rows-1 mb-2 gap-1">
          <div class="dato flex items-center justify-start gap-2">
            <label for="ancho-mapa">Ancho</label>
            <input name="ancho-mapa" id="ancho-mapa" type="number" class="input bg-gray-200 rounded-sm p-1 text-right" min="1" max="30" value="5">
          </div>
          <div class="dato flex items-center justify-start gap-2">
            <label for="alto-mapa">Alto</label>
            <input name="alto-mapa" id="alto-mapa" type="number" class="input bg-gray-200 rounded-sm p-1 text-right" min="1" max="30" value="5">
          </div>
           <div class="flex justify-end">
             <button id="btn-aplicar-dimensiones" class="bg-indigo-600 rounded-sm text-white font-bold px-2 py-1 text-center cursor-pointer">Aplicar dimensiones</button>
           </div>
        </div>

        <!-- Brocha pintar, seleccionar o borrar (solo en brocha de unidad) -->
        <!-- COMPONENTE TAB -->
        <style>
          .tab-content{
            transition: height 1s;
          }

          .nav-link{
            transition: background-color .275s;
            cursor: pointer;
            &.seleccionado{
              background-color: darkorange;
              color: white;
            }
          }
          .tab-pane{
            display: none;
            &.seleccionado{
              display: unset;
            }
          }
        </style>
        <script>
          window.addEventListener('load', ()=>{
            const navLinks = [...document.querySelectorAll('.nav-link')]
            navLinks.forEach(navLink => {
              navLink.addEventListener('click', (ev)=>{
                navLinks.forEach(navLink => {
                  navLink.classList.remove('seleccionado')
                  const targetLinkTabtemp = navLink.getAttribute('data-bs-target')
                  document.querySelector(targetLinkTabtemp).classList.remove('seleccionado')
                });
                ev.target.classList.add('seleccionado')
                const targetLinkTab = ev.target.getAttribute('data-bs-target')
                document.querySelector(targetLinkTab).classList.add('seleccionado')
              })
            });
          });
        </script>
        <section class="seccion-brocha tab border-2 border-black border-solid rounded-sm overflow-hidden">
          <div class="nav-tabs bg-zinc-300 w-1/1 grid grid-cols-2 grid-rows-1">
            <button class="nav-link seleccionado text-center font-bold px-3 py-2 block" id="nav-brocha-terreno" data-bs-target="#tab-terreno">Brocha terreno</button>
            <button class="nav-link text-center font-bold px-3 py-2 block" id="nav-brocha-unidad" data-bs-target="#tab-unidad">Brocha unidad</button>
          </div>
          <div class="tab-content bg-slate-100 p-2">
            <section class="tab-pane seleccionado" id="tab-terreno">
              <div class="modo-brocha grid grid-cols-3 mb-2">
                <div class="font-bold">
                  MODO:
                </div>
                <div>
                  <input id="brocha-terreno-pintar" type="radio" name="modo-brocha-textura" value="pintar" checked>
                  <label for="brocha-terreno-pintar">Pintar</label>
                </div>
                <div>
                  <input id="brocha-terreno-seleccionar" type="radio" name="modo-brocha-textura" value="seleccionar">
                  <label for="brocha-terreno-seleccionar">Seleccionar</label>
                </div>
              </div>
              
              <label for="brocha-casilla">Terreno</label>
              <select name="brocha-casilla" id="brocha-casilla" class="bg-gray-300 rounded-sm px-2 py-1">
                <option value="planicie">Planicie</option>
                <!-- Rellenar automáticamente -->
              </select>

              <!-- Se puede ocultar (o deshabilitar) automáticamente dependiendo si la zona seleccionada es o no una propiedad -->
              <!-- Tentativamente quiero el límite sea hasta 8 (16 se me hacen demasiados) -->
              <!-- <div class="seccion-propietario">
                <div class="dato flex items-center justify-center gap-2">
                  <label for="propietario-casilla">Propietario</label>
                  <input name="propietario-casilla" id="propietario-casilla" type="number" class="input bg-gray-200 rounded-sm p-1" min="0" max="3">
                </div>
              </div> -->

              <div class="seccion-mirror grid grid-cols-2 grid-rows-1">
                <div class="flex items-center">
                  <p title="Indica si los terrenos que pones en un lado aplican del otro">Espejo (?)</p>
                </div>
                <div class="flex gap-2 flex-wrap">
                  <select name="opcion-espejo" id="opcion-espejo" class="bg-gray-300 rounded-sm px-2 py-1">
                    <option value="ninguno">Ninguno</option>
                    <option value="horizontal">Horizontal</option>
                    <option value="vertical">Vertical</option>
                    <option value="diagonal-2">Diagonal \</option>
                    <option value="diagonal-1">Diagonal /</option>
                  </select>
                </div>
              </div>
            </section>
            <section class="tab-pane" id="tab-unidad">
              <div class="modo-brocha grid grid-cols-4 mb-2">
                <div class="font-bold">
                  MODO:
                </div>
                <div>
                  <input id="brocha-unidad-pintar" type="radio" name="modo-brocha-unidad" value="pintar" checked>
                  <label for="brocha-unidad-pintar">Pintar</label>
                </div>
                <div>
                  <input id="brocha-unidad-seleccionar" type="radio" name="modo-brocha-unidad" value="seleccionar">
                  <label for="brocha-unidad-seleccionar">Seleccionar</label>
                </div>
                <div>
                  <input id="brocha-unidad-borrar" type="radio" name="modo-brocha-unidad" value="borrar">
                  <label for="brocha-unidad-borrar">Borrar</label>
                </div>
              </div>
              <label for="brocha-unidad">Unidad</label>
              <select name="brocha-unidad" id="brocha-unidad" class="bg-gray-300 rounded-sm px-2 py-1">
                <option value="infanteria">Infantería</option>
                <!-- Rellenar automáticamente -->
              </select>

            </section>
          </div>

          <p>CASILLA (0,0)</p>
        </section>
      </form>
    </div>
    <main class="gap-2">
      <div id="mapa-konva">
        <!-- Konva -->
      </div>
      <div class="seccion-analisis p-3 flex flex-col items-center justify-center gap-1 bg-amber-100 rounded-md text-center">
          <h1 class="text-2xl font-bold">Análisis</h1>
          <output id="num-jugador">0 jugadores</output>
          <div class="seccion-num-propiedades ">
            <h1>Propiedades</h1>
            <!-- TODO: cambiar por iconos -->
            <output id="num-ciudades">0 ciudades</output>
            <output id="num-fabricas">0 fábricas</output>
            <output id="num-aeropuertos">0 Aeropuertos</output>
            <output id="num-puertos-navales">0 puertos navales</output>
          </div>

          <h1 id="txt-apto" class="font-bold">Apto para juegos: <output class="text-green-600">SI/NO</output></h1>

          <!-- unidades -->
          <div class="modal-requerimientos">
            <p>
              <b>Requisitos:</b>
              <ul class="list-disc text-left pl-4">
                <li>Tener al menos 2 fábricas de propietarios distintos y/o 2 unidades de propietarios distintos</li>
                <li>Dimensiones de al menos 5 x 5</li>
              </ul>
            </p>
          </div>

          <div class="flex justify-end">
            <!-- DESHABILITAR BOTÓN HASTA QUE CUMPLA QUE SEA UN MAPA APTO PARA JUEGOS -->
            <input type="submit" value="Guardar mapa" class="bg-green-700 rounded-sm text-white font-bold px-2 py-1 text-center cursor-pointer">
          </div>
      </div>

      <!-- COMPONENTE MODAL -->
      <style>
        .modal{
          display: none;
          position: fixed;
          top: 0%;
          width: 100%; height: 100%;
          background-color: rgba(59, 59, 59, 0.342);

          .content{
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            padding: 20px;
            position: fixed;
            top: auto; left: auto;
            box-shadow: 2px 2px 2px rgba(95, 95, 95, 0.404);
            width: 800px;
            max-width: 90%;
            max-height: 70%;
            /* opacity: 0; */
            /* transition: opacity .5s; */
          }
          &.activo{
            display: flex; align-items: center; justify-content: center;
            opacity: 1;
          }
        }
      </style>
      <script>
        window.addEventListener('load', ()=>{
          document.querySelector('#modal-recomendaciones').addEventListener('click', (ev)=>{
            ev.target.classList.remove('activo')
          })
        });
      </script>
      <div id="modal-recomendaciones" class="modal">
        <div class="content">
          <h1 class="font-bold text-1xl">Instrucciones</h1>
            <ol class="text-left pl-4 list-decimal">
              <li>Define un ancho y alto para tu mapa</li>
              <li>
                En la pestaña de "Brocha terreno", escoge un terreno y pinta las casillas del mapa con el cursor.
              </li>
              <li>
                Si quieres agregar unidades, cambia a la pestaña de "Brocha unidades", 
                escoge la unidad que quieras agregar y has clic en la casillas que quieras.
              </li>
              <li>
                Para seleccionar haz clic en la opción de seleccionar. Esto te ayudará para cambiar el propietario de una casilla (si es que aplica)
                o para editar los valores de una unidad (ej: propietario, puntos de vida, municiones, etc.)
              </li>
              <li>En el caso de las unidades, puedes seleccionar la opción de brocha de borrar y hacer clic en un casilla para quitar la unidad</li>
            </ol>
            <br>
            <h2 class="font-bold text-1xl">Recomendaciones</h2>
            <ul class="list-disc text-left pl-4">
              <li>Planea para cuántos jugadores sería tu mapa antes de decidir el tamaño</li>
              <li>
                Escoge un tamaño de al menos 15x15 hasta 30x25 para mapas de 2 jugadores.
                <br>
                Fuera de ese rango serían o muy chicos o muy grandes
              </li>
              <li>Es preferible que el mapa sea más ancho que más alto (en caso de no ser cuadrado)</li>
              <li>Si quieres que sea un mapa balanceado, aprovecha la opción de <b>Espejo</b> para hacer el mapa simétrico</li>
              <li>
                De preferencia, haz que el combate tenga al menos 2 frentes, uno débil y otro fuerte. Esto ayudará a que el combate sea más dinámico, pues no hay un solo frente que defender o atacar.
              </li>
            </ul>
            <br>

            <p>Para más consejos, revisa este <a class="font-black" target="_blank" href="https://www.youtube.com/watch?v=_-YERC94VIg">VIDEO</a></p>
        </div>
      </div>
    </main>
    <script type="module" src="/src/GeneradorMapas.ts"></script>
    <script type="module" src="/src/componentes/header.ts"></script>
    <script type="module" src="/src/componentes/form_creadormapas.ts"></script>
  </body>
</html>
